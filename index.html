<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Word Scramble ‚Äî ‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏™‡∏•‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå</title>
<meta name="description" content="Word Scramble ‚Äî ‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏™‡∏•‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏™‡∏Å‡πå‡∏ó‡πá‡∏≠‡∏õ" />
<style>
:root{
  --bg:#071322;
  --panel:#0b1b2a;
  --accent:#00d4a6;
  --muted:#98b0c0;
  --text:#e9fbf5;
  --mono:"Courier New", Courier, monospace;
}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--text);background:linear-gradient(180deg,#04111a,#071322);display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:12px;}
.wrap{width:980px;max-width:96%;display:grid;gap:12px;}
.panel{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:12px;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,0.5)}
.scramble{font-family:var(--mono);font-size:36px;letter-spacing:6px;padding:16px;border-radius:8px;background:rgba(255,255,255,0.02);text-align:center;min-width:260px;}
.btn{background:#08202d;border:none;padding:8px 12px;border-radius:8px;color:var(--text);cursor:pointer;box-shadow:0 6px 12px rgba(0,0,0,0.5);transition:0.1s;}
.btn:hover{filter:brightness(1.15);}
.btn:active{transform:scale(0.92);}
@keyframes pulseStart {
  0%   { transform: scale(1); box-shadow: 0 0 0 rgba(0,212,166,0.0); }
  50%  { transform: scale(1.12); box-shadow: 0 0 18px rgba(0,212,166,0.55); }
  100% { transform: scale(1); box-shadow: 0 0 0 rgba(0,212,166,0.0); }
}

.start-animate {
  animation: pulseStart 1s infinite;
}
@keyframes blinkRed {
  0%   { color: #ff4d4d; text-shadow: 0 0 6px rgba(255,77,77,0.6); }
  50%  { color: #ffffff; text-shadow: none; }
  100% { color: #ff4d4d; text-shadow: 0 0 6px rgba(255,77,77,0.6); }
}

.timer-warning {
  animation: blinkRed 0.6s infinite;
}


input[type="text"], input[type="number"]{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);font-size:16px;}
.controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:8px;}
.leader{list-style:none;padding:0;margin:0;display:grid;gap:6px;}
li.entry{display:flex;justify-content:space-between;padding:8px;background:rgba(255,255,255,0.02);border-radius:6px;font-size:14px;}
.feedback{width:100%;margin-top:8px;text-align:center;color:var(--muted);font-size:13px;}

</style>

</head>
<body>
<div class="wrap" role="application" aria-label="Word Scramble - ‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏™‡∏•‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå">
  <header>
    <h1>Word Scramble ‚Äî ‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏™‡∏•‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå</h1>
  </header>

  <section class="panel center">
    <div style="display:flex;gap:12px;justify-content:space-between">
      <div>‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: <span id="leftCount">--</span></div>
      <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="score">0</span></div>
      <div>‡πÄ‡∏ß‡∏•‡∏≤: <span id="timer">--</span></div>
    </div>

    <div id="scrambled" class="scramble" aria-live="polite">A P P L E</div>

    <form id="guessForm" style="display:flex;gap:8px;align-items:center" autocomplete="off">
      <input id="guess" name="guess" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á..." autocomplete="off" />
      <button id="submitBtn" class="btn" type="submit">‚Äú‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‚Äù</button>
    </form>

    <div class="controls">
      <button id="startBtn" class="btn small start-animate">üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
      <button id="skipBtn" class="btn small">‡∏Ç‡πâ‡∏≤‡∏°‡∏Ñ‡∏≥ (-1)</button>
      <button id="hintBtn" class="btn small">‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢ (-2)</button>
      <button id="endBtn" class="btn small">‚õî ‡∏à‡∏ö‡πÄ‡∏Å‡∏°</button>

    </div>

    <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;justify-content:center">
      <button class="btn small" data-mode="easy">‡∏á‡πà‡∏≤‡∏¢</button>
      <button class="btn small" data-mode="normal" style="outline:2px solid rgba(0,212,166,0.18)">‡∏õ‡∏Å‡∏ï‡∏¥</button>
      <button class="btn small" data-mode="hard">‡∏¢‡∏≤‡∏Å</button>
    </div>

    <div style="margin-top:8px;text-align:center">
      ‡πÄ‡∏ß‡∏•‡∏≤/‡∏Ñ‡∏≥: <input type="number" id="timePerWord" value="20" min="5" max="60" style="width:60px;" /> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    </div>

    <div class="feedback" id="feedback"></div>

    <div style="margin-top:12px;text-align:center">
      <button id="resetLB" class="btn small">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

    </div>

    <ul id="leaderboard" class="leader"></ul>
    
  </section>
</div>

<section class="panel" style="font-size:14px;line-height:1.7;color:var(--muted);margin-top:12px">
  <h3 style="margin-top:0;color:var(--text);text-align:center">üìò ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</h3>
  <ul style="padding-left:18px">
    <li>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° <b>üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</li>
    <li>‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á <b>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</b></li>
    <li>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î <b>‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</b></li>
    <li>‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏à‡∏∞‡πÑ‡∏î‡πâ <b>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô + ‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏ö‡∏ô‡∏±‡∏™</b></li>
    <li>‡∏ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î (‡πÇ‡∏´‡∏°‡∏î‡∏¢‡∏≤‡∏Å) ‡∏à‡∏∞ <b>‡πÇ‡∏î‡∏ô‡∏´‡∏±‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</b></li>
    <li>‡∏õ‡∏∏‡πà‡∏° <b>‡∏Ç‡πâ‡∏≤‡∏°‡∏Ñ‡∏≥</b> ‡∏à‡∏∞‡∏´‡∏±‡∏Å <b>-1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</b></li>
    <li>‡∏õ‡∏∏‡πà‡∏° <b>‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢</b> ‡∏à‡∏∞‡πÄ‡∏â‡∏•‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ 1 ‡∏ï‡∏±‡∏ß ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏Å <b>-2 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</b></li>
    <li>‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≥‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡∏´‡∏≤‡∏Å‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏â‡∏•‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>
    <li>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏ö‡πÄ‡∏Å‡∏° ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ <b>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏á Leaderboard</b> ‡πÑ‡∏î‡πâ</li>
  </ul>

  <div style="margin-top:6px">
    <b>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å:</b><br>
    ‚úÖ <b>‡∏á‡πà‡∏≤‡∏¢</b> = ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡πâ‡∏≠‡∏¢<br>
    ‚úÖ <b>‡∏õ‡∏Å‡∏ï‡∏¥</b> = ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô<br>
    ‚úÖ <b>‡∏¢‡∏≤‡∏Å</b> = ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏ï‡πà‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î‡πÇ‡∏î‡∏ô‡∏´‡∏±‡∏Å
  </div>
</section>


<audio id="bgm" preload="auto"></audio>

<button id="musicBtn" class="btn small" style="position:fixed;bottom:16px;right:16px;">üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á</button>
<button id="sfxBtn" class="btn small" style="position:fixed;bottom:16px;right:94px;">üîî SFX: ‡πÄ‡∏õ‡∏¥‡∏î</button>

<script>
// ================== WORDS ==================
const WORDS = Array.from(new Set([
  "apple","banana","orange","grape","mango","python","coding","keyboard","monitor","laptop",
  "internet","server","client","window","picture","bottle","coffee","chocolate","diamond",
  "‡πÅ‡∏°‡∏ß","‡∏™‡∏∏‡∏ô‡∏±‡∏Ç","‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢","‡∏™‡∏°‡∏∏‡∏î","‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå","‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå","‡∏≠‡∏≤‡∏´‡∏≤‡∏£","‡∏Å‡∏≤‡πÅ‡∏ü","‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠","‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô",
  "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô","‡∏Ñ‡∏£‡∏π","‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô","‡∏ï‡∏•‡∏≤‡∏î","‡∏™‡∏ô‡∏≤‡∏°","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô","‡πÄ‡∏ß‡∏•‡∏≤","‡πÄ‡∏û‡∏•‡∏á","‡∏†‡∏≤‡∏û‡∏¢‡∏ô‡∏ï‡∏£‡πå","‡πÇ‡∏ó‡∏£"
])).filter(Boolean);

const LB_KEY = 'ws_leader_v1';

// ================== UI ==================
const scrambledEl = document.getElementById('scrambled');
const guessInput = document.getElementById('guess');
const submitBtn = document.getElementById('submitBtn');
const startBtn = document.getElementById('startBtn');
const skipBtn = document.getElementById('skipBtn');
const hintBtn = document.getElementById('hintBtn');
const feedback = document.getElementById('feedback');
const scoreEl = document.getElementById('score');
const leftCountEl = document.getElementById('leftCount');
const timerEl = document.getElementById('timer');
const lbEl = document.getElementById('leaderboard');
const resetLB = document.getElementById('resetLB');
const endBtn = document.getElementById('endBtn');

const timePerWordInput = document.getElementById('timePerWord');
const bgm = document.getElementById('bgm');
const musicBtn = document.getElementById('musicBtn');
const sfxBtn = document.getElementById('sfxBtn');
const guessForm = document.getElementById('guessForm');

let remaining=[], current='', scrambled='', score=0, timePerWord=20, timer=null, timeLeft=0, mode='normal';
let sfxEnabled=true, bgmEnabled=false, blocked=false, revealedIndexes=[];

// ========== Playlist ==========
const playlist = [
  "music1.mp3",
  "music2.mp3",
  "music3.mp3",
  "music4.mp3",
  "music5.mp3",
  "music6.mp3"
];

let currentTrack = 0;

function playCurrentTrack() {
  bgm.src = playlist[currentTrack];
  bgm.volume = 0.36;
  bgm.play().catch(()=>{});  // ‚Üê ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡∏à‡∏£‡∏¥‡∏á ‡πÜ
}


// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á‡∏à‡∏ö ‚Üí ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡∏ï‡πà‡∏≠
bgm?.addEventListener('ended', () => {
  currentTrack = (currentTrack + 1) % playlist.length;  // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ
  playCurrentTrack();
});

function randomTrack() {
  currentTrack = Math.floor(Math.random() * playlist.length);
  console.log("‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á:", playlist[currentTrack]);
}


// ================== AudioContext ==================
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx=null; try{ audioCtx=new AudioCtx(); }catch(e){ audioCtx=null; }
function playTone(freq,duration,type='sine',volume=0.25){ if(!audioCtx) return; try{ const now=audioCtx.currentTime; const osc=audioCtx.createOscillator(); const gain=audioCtx.createGain(); osc.type=type; osc.frequency.setValueAtTime(freq,now); gain.gain.setValueAtTime(volume,now); osc.connect(gain); gain.connect(audioCtx.destination); osc.start(now); osc.stop(now+duration); }catch(e){} }
function sfxClick(){ if(!sfxEnabled) return; playTone(520,0.04,'square',0.12);}
function sfxCorrect(){ if(!sfxEnabled) return; playTone(900,0.12,'triangle',0.28); setTimeout(()=>playTone(1200,0.06,'sine',0.14),120);}
function sfxWrong(){ if(!sfxEnabled) return; playTone(180,0.22,'sawtooth',0.36); navigator.vibrate&&navigator.vibrate(60);}
function sfxStart(){ if(!sfxEnabled) return; playTone(600,0.14,'sine',0.22); setTimeout(()=>playTone(820,0.12,'triangle',0.18),120);}
function sfxTimeout(){ if(!sfxEnabled) return; playTone(120,0.46,'sawtooth',0.38);}
function sfxWarning(){
  if(!sfxEnabled) return;
  playTone(1800, 0.05, 'square', 0.08); // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ï‡∏¥‡πä‡∏Å‡πÅ‡∏ö‡∏ö‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤
}


function sfxEnd(){ if(!sfxEnabled) return; playTone(800,0.14); setTimeout(()=>playTone(600,0.12),140); setTimeout(()=>playTone(1000,0.22),320);}
document.addEventListener('click',e=>{ if(e.target.closest('.btn')){ audioCtx && audioCtx.resume && audioCtx.resume(); sfxClick(); }});

// ================== Helpers ==================
function safeShuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];}}
function scrambleWord(word){const chars=Array.from(word); if(chars.length<=2) return word; let sh=chars.slice(), attempts=0; do{ safeShuffle(sh); attempts++; if(attempts>80) break;}while(sh.join('')===chars.join('')); return sh.join('');}
function chooseNext(){if(remaining.length===0) return null; current=remaining.shift(); scrambled=scrambleWord(current); revealedIndexes=[]; return {current,scrambled};}
function normalize(s){ return String(s).toLowerCase().replace(/\s+/g,'').normalize('NFC'); }
function escapeHtml(s){return String(s).replace(/[&<>"'`]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','`':'&#96;'}[c]));}

// ================== Timer & Score ==================
function updateTimer(){ timerEl.textContent=`${timeLeft}s`; }
function updateScore(){ scoreEl.textContent=score; }
function clearTimer(){if(timer){clearInterval(timer);timer=null;}}

// ================== Game Logic ==================
function startGame() {
  startBtn.classList.remove('start-animate');
  endBtn.classList.add('start-animate');

  if (blocked) return;
  blocked = true;
  setTimeout(() => blocked = false, 600);

  audioCtx && audioCtx.resume && audioCtx.resume();

  // üéµ ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
  randomTrack();

  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏•‡∏á‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î ‚Üí ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
  if (bgmEnabled) {
    playCurrentTrack();
  }

  sfxStart();
  remaining = WORDS.slice();
  safeShuffle(remaining);
  score = 0;
  updateScore();

  feedback.textContent = '';
  timePerWord = Math.max(5, parseInt(timePerWordInput.value, 10) || 20);

  nextWord();
}



function nextWord(){ clearTimer(); const pair=chooseNext(); if(!pair){ gameEnd(); return;} scrambledEl.textContent=pair.scrambled.split('').join(' '); leftCountEl.textContent=remaining.length+1; guessInput.value=''; guessInput.focus(); startTimer(); }

function startTimer(){
  timeLeft = timePerWord;
  updateTimer();
  timerEl.classList.remove('timer-warning');

  timer = setInterval(() => {
    timeLeft--;
    updateTimer();

    // ‚úÖ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ = ‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡πÅ‡∏î‡∏á + ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ï‡∏¥‡πä‡∏Å
    if (timeLeft <= 5 && timeLeft > 0) {
      timerEl.classList.add('timer-warning');
      sfxWarning();
    }

    // ‚úÖ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤
    if (timeLeft <= 0) {
      sfxTimeout();
      clearTimer();
      timerEl.classList.remove('timer-warning');
      feedback.textContent = `‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤! ‡∏Ñ‡∏≥‡∏Ñ‡∏∑‡∏≠: ${escapeHtml(current)}`;
      setTimeout(nextWord, 900);
    }

  }, 1000);
}

function endGameManual(){
  endBtn.classList.remove('start-animate');


  if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?')){
    clearTimer();
    sfxEnd();
    scrambledEl.textContent = '‡∏Ñ‡∏∏‡∏ì‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß üèÅ';
    leftCountEl.textContent = 0;

    setTimeout(() => {
      const name = prompt(`‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${score}\n‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡∏Å‡∏î‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å):`, '‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô');
      if(name !== null){
        pushScore(name.trim() || '‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô', score);
      }
      renderLB();
    }, 200);
  }
}




function checkGuess(){ if(blocked) return; blocked=true; setTimeout(()=>blocked=false,300); const g=(guessInput.value||'').trim(); if(!g) return;
  if(normalize(g)===normalize(current)){let pts=10;if(mode==='easy') pts=6;if(mode==='hard') pts=14; pts+=Math.floor(timeLeft/2); score+=pts; updateScore(); feedback.textContent=`‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! +${pts} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‚úÖ`; sfxCorrect(); scrambledEl.classList.add('correct'); setTimeout(()=>{ scrambledEl.classList.remove('correct'); nextWord(); },500); } 
  else { feedback.textContent='‡∏ú‡∏¥‡∏î ‚Äî ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà ‚ùå'; if(mode==='hard') score=Math.max(0,score-2); updateScore(); sfxWrong(); scrambledEl.classList.add('wrong'); setTimeout(()=>{ scrambledEl.classList.remove('wrong'); },400); guessInput.value=''; guessInput.focus(); }
}

function skipWord(){ if(blocked) return; blocked=true; setTimeout(()=>blocked=false,400); score=Math.max(0,score-1); updateScore(); feedback.textContent=`‡∏Ç‡πâ‡∏≤‡∏°‡∏Ñ‡∏≥ ‚Äî -1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏Ñ‡∏≥‡∏Ñ‡∏∑‡∏≠: ${escapeHtml(current)})`; nextWord(); }

function hint(){ if(blocked) return; blocked=true; setTimeout(()=>blocked=false,400); if(!current) return; let idx; do{ idx=Math.floor(Math.random()*current.length);}while(revealedIndexes.includes(idx)&&revealedIndexes.length<current.length); revealedIndexes.push(idx); feedback.textContent=`‡∏Æ‡∏¥‡∏ô‡∏ï‡πå: ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ${idx+1} ‡∏Ñ‡∏∑‡∏≠ "${escapeHtml(current[idx])}" (-2 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)`; score=Math.max(0,score-2); updateScore(); }

// ================== Game End / Leaderboard ==================
function gameEnd(){
endBtn.classList.remove('start-animate'); // ‚úÖ ‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏ö‡πÄ‡∏Å‡∏°


 sfxEnd(); clearTimer(); scrambledEl.textContent='‡∏à‡∏ö‡πÄ‡∏Å‡∏° üéâ'; leftCountEl.textContent=0; setTimeout(()=>{ const name=prompt(`‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${score}\n‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡∏Å‡∏î‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å):`,'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô'); if(name!==null){ pushScore(name.trim()||'‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô',score);} renderLB(); },200); }

function loadLB(){ try{return JSON.parse(localStorage.getItem(LB_KEY)||'[]');}catch(e){return[];} }
function saveLB(arr){ try{localStorage.setItem(LB_KEY,JSON.stringify(arr));}catch(e){} }
function pushScore(name,sc){ const arr=loadLB(); arr.push({name:name,score:sc,t:Date.now()}); arr.sort((a,b)=>b.score-a.score); saveLB(arr.slice(0,10)); }
function renderLB(){ const arr=loadLB(); lbEl.innerHTML=''; if(arr.length===0){ lbEl.innerHTML='<li class="entry" style="justify-content:center;color:var(--muted)">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</li>'; return;} arr.forEach((e,i)=>{ const li=document.createElement('li'); li.className='entry'; li.innerHTML=`<span>#${i+1} ${escapeHtml(e.name)}</span><span>${e.score}</span>`; lbEl.appendChild(li); }); }

// ================== Events ==================
guessForm.addEventListener('submit',e=>{ e.preventDefault(); checkGuess(); });
submitBtn.addEventListener('click',e=>{ e.preventDefault(); checkGuess(); });
startBtn.addEventListener('click',()=>startGame());
skipBtn.addEventListener('click',()=>skipWord());
hintBtn.addEventListener('click',()=>hint());
resetLB.addEventListener('click',()=>{ if(confirm('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï Leaderboard ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á?')){ localStorage.removeItem(LB_KEY); renderLB(); } });
document.querySelectorAll('[data-mode]').forEach(btn=>{ btn.addEventListener('click',()=>{ document.querySelectorAll('[data-mode]').forEach(b=>b.style.outline=''); btn.style.outline='2px solid rgba(0,212,166,0.18)'; mode=btn.dataset.mode; }); });
musicBtn.addEventListener('click', () => {
  audioCtx && audioCtx.resume && audioCtx.resume();
  bgmEnabled = !bgmEnabled;

  if (bgmEnabled) {
    // üéµ ‡πÉ‡∏´‡πâ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á
    randomTrack();
    playCurrentTrack();
    musicBtn.textContent = 'üîá ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á';
  } else {
    bgm.pause();
    musicBtn.textContent = 'üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á';
  }
});


sfxBtn.addEventListener('click',()=>{ sfxEnabled=!sfxEnabled; sfxBtn.textContent=`üîî SFX: ${sfxEnabled?'‡πÄ‡∏õ‡∏¥‡∏î':'‡∏õ‡∏¥‡∏î'}`; });
scrambledEl.addEventListener('click',()=>guessInput.focus());
endBtn.addEventListener('click',()=>endGameManual());

</script>

<script
  type="text/javascript"
  src="https://pl28240558.effectivegatecpm.com/0c/66/d0/0c66d0bfad1f4d8961db21055695b8e1.js"
></script>

</body>
</html>